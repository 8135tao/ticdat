<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>PostgresTicFactory - Ticdat</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "PostgresTicFactory";
    var mkdocs_page_input_path = "pgtd.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Ticdat</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">pandatfactory.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../pandatfactory/">PanDatFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">pandatio.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../pandatio/">CsvPanFactory</a>
                </li>
                <li class="">
                    
    <a class="" href="../pandatio/">JsonPanFactory</a>
                </li>
                <li class="">
                    
    <a class="" href="../pandatio/">SqlPanFactory</a>
                </li>
                <li class="">
                    
    <a class="" href="../pandatio/">XlsPanFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">ticdatfactory.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../ticdatfactory/">TicDatFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">csvtd.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../csvtd/">CsvTicFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">jsontd.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../jsontd/">JsonTicFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">mdb.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../mdb/">MdbTicFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">pgtd.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="./">PostgresPanFactory</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">PostgresTicFactory</a>
    <ul class="subnav">
            
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">sqlitetd.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../sqlitetd/">SQLiteTicFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">xls.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../xls/">XlsTicFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">utils.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../utils/">Utilities</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">model.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../model/">Model</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">opl.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../opl/">OPL</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Ticdat</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>pgtd.py &raquo;</li>
        
      
    
    <li>PostgresTicFactory</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/ticdat/ticdat/edit/master/docs/pgtd.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="ticdat.pgtd.PostgresPanFactory">PostgresPanFactory</h1>

<pre><code class="python">PostgresPanFactory(self, pan_dat_factory)
</code></pre>

<p>Primary class for reading/writing PostGres databases with PanDat objects.</p>
<p>Don't create this object explicitly. A PostgresPanFactory will automatically be associated with the
pgsql attribute of the parent PanDatFactory.</p>
<p>Will need to have pandas installed to do anything.</p>
<p>postgres doesn't support brackets, and putting spaces in postgres field names is frowned upon.
https://bit.ly/2xWLZL3.
You <strong>are</strong> encouraged to continue to use field names like "Min Nutrition" in your ticdat Python code, and the
pgtd code here will match such fields up with postgres field names like min_nutrition when reading/writing from
a postgres DB. (Non alphamnumeric characters in general, and not just spaces, are replaced with underscores
for generating PGSQL field names).</p>
<h2 id="ticdat.pgtd.PostgresPanFactory.create_pan_dat">create_pan_dat</h2>

<pre><code class="python">PostgresPanFactory.create_pan_dat(self, engine, schema, active_fld='')
</code></pre>

<p>Create a PanDat object from a PostGres connection</p>
<p>:param engine: A sqlalchemy connection to the PostGres database</p>
<p>:param schema : The name of the schema to read from</p>
<p>:param active_fld: if provided, a string for a boolean filter field.
                   Must be compliant w PG naming conventions, which are different from ticdat field naming
                   conventions. Typically developer can ignore this argument, designed for expert support.</p>
<p>:return: a PanDat object populated by the matching tables. Missing tables issue a warning and resolve
         to empty.</p>
<h2 id="ticdat.pgtd.PostgresPanFactory.write_data">write_data</h2>

<pre><code class="python">PostgresPanFactory.write_data(self, pan_dat, engine, schema, pre_existing_rows=None, active_fld='', progress=None)
</code></pre>

<p>write the PanDat data to a postgres database</p>
<p>:param pan_dat: a PanDat object</p>
<p>:param engine: A sqlalchemy connection to the PostGres database</p>
<p>:param schema: The postgres schema to write to (call self.write_schema explicitly as needed)</p>
<p>:param pre_existing_rows: if provided, a dict mapping table name to either "delete" or "append"
                          default behavior is "delete"</p>
<p>:param active_fld: if provided, a string for a boolean filter field which will be populated with True.
                   Must be compliant w PG naming conventions, which are different from ticdat field naming
                   conventions. Typically developer can ignore this argument, designed for expert support.</p>
<p>:param progress: if provided, a ticdat.Progress object that is called every time a table is uploaded</p>
<p>:return:</p>
<h1 id="ticdat.pgtd.PostgresTicFactory">PostgresTicFactory</h1>

<pre><code class="python">PostgresTicFactory(self, tic_dat_factory)
</code></pre>

<p>Primary class for reading/writing PostGres databases with TicDat objects.
You need the sqlalchemy package to be installed to use it.</p>
<p>Don't create this object explicitly. A PostgresTicFactory will automatically be associated with the
pgsql attribute of the parent TicDatFactory.</p>
<p>postgres doesn't support brackets, and putting spaces in postgres field names is frowned upon.
https://bit.ly/2xWLZL3.
You <strong>are</strong> encouraged to continue to use field names like "Min Nutrition" in your ticdat Python code, and the
pgtd code here will match such fields up with postgres field names like min_nutrition when reading/writing from
a postgres DB. (Non alphamnumeric characters in general, and not just spaces, are replaced with underscores
for generating PGSQL field names)</p>
<h2 id="ticdat.pgtd.PostgresTicFactory.create_tic_dat">create_tic_dat</h2>

<pre><code class="python">PostgresTicFactory.create_tic_dat(self, engine, schema, freeze_it=False, active_fld='')
</code></pre>

<p>Create a TicDat object from a PostGres connection</p>
<p>:param engine: A sqlalchemy connection to the PostGres database</p>
<p>:param schema : The name of the schema to read from</p>
<p>:param freeze_it: boolean. should the returned object be frozen?</p>
<p>:param active_fld: if provided, a string for a boolean filter field.
                   Must be compliant w PG naming conventions, which are different from ticdat field naming
                   conventions. Typically developer can ignore this argument, designed for expert support.</p>
<p>:return: a TicDat object populated by the matching tables. Missing tables issue a warning and resolve
         to empty.</p>
<h2 id="ticdat.pgtd.PostgresTicFactory.find_duplicates">find_duplicates</h2>

<pre><code class="python">PostgresTicFactory.find_duplicates(self, engine, schema, active_fld='')
</code></pre>

<p>Find the row counts for duplicated rows.</p>
<p>:param engine: A sqlalchemy Engine object that can connect to our postgres instance</p>
<p>:param schema: Name of the schema within the engine's database to use</p>
<p>:param active_fld: if provided, a string for a boolean filter field.
                   Must be compliant w PG naming conventions, which are different from ticdat field naming
                   conventions. Typically developer can ignore this argument, designed for expert support.</p>
<p>:return: A dictionary whose keys are table names for the primary-ed key tables.
         Each value of the return dictionary is itself a dictionary.
         The inner dictionary is keyed by the primary key values encountered in the table,
         and the value is the count of records in the postgres table with this primary key.
         Row counts smaller than 2 are pruned off, as they aren't duplicates</p>
<h2 id="ticdat.pgtd.PostgresTicFactory.write_data">write_data</h2>

<pre><code class="python">PostgresTicFactory.write_data(self, tic_dat, engine, schema, dsn=None, pre_existing_rows=None, active_fld='')
</code></pre>

<p>write the ticDat data to a PostGres database</p>
<p>:param tic_dat: the data object to write</p>
<p>:param engine: a sqlalchemy database engine with drivertype postgres</p>
<p>:param schema: the postgres schema to write to (call self.write_schema explicitly as needed)</p>
<p>:param dsn: optional - if truthy, a dict that can be unpacked as arguments to
            psycopg2.connect. Will speed up bulk writing compared to engine.execute
            If truthy and not a dict, then will be passed directly to psycopg2.connect as the sole argument.</p>
<p>:param pre_existing_rows: if provided, a dict mapping table name to either "delete" or "append"
                          default behavior is "delete"</p>
<p>:param active_fld: if provided, a string for a boolean filter field which will be populated with True.
                   Must be compliant w PG naming conventions, which are different from ticdat field naming
                   conventions. Typically developer can ignore this argument, designed for expert support.
:return:</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../sqlitetd/" class="btn btn-neutral float-right" title="SQLiteTicFactory">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="./" class="btn btn-neutral" title="PostgresPanFactory"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/ticdat/ticdat/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="./" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../sqlitetd/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
