<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>CsvTicFactory - Ticdat</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "CsvTicFactory";
    var mkdocs_page_input_path = "csvtd.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Ticdat</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">pandatfactory.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../pandatfactory/">PanDatFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">pandatio.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../pandatio/">CsvPanFactory</a>
                </li>
                <li class="">
                    
    <a class="" href="../pandatio/">JsonPanFactory</a>
                </li>
                <li class="">
                    
    <a class="" href="../pandatio/">SqlPanFactory</a>
                </li>
                <li class="">
                    
    <a class="" href="../pandatio/">XlsPanFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">ticdatfactory.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../ticdatfactory/">TicDatFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">csvtd.py</span>
    <ul class="subnav">
                <li class=" current">
                    
    <a class="current" href="./">CsvTicFactory</a>
    <ul class="subnav">
            
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">jsontd.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../jsontd/">JsonTicFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">mdb.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../mdb/">MdbTicFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">sqlitetd.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../sqlitetd/">SQLiteTicFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">xls.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../xls/">XlsTicFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">utils.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../utils/">Utilities</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">model.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../model/">Model</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">opl.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../opl/">OPL</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">lingo.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../lingo/">Lingo</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Ticdat</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>csvtd.py &raquo;</li>
        
      
    
    <li>CsvTicFactory</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/ticdat/ticdat/edit/master/docs/csvtd.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="ticdat.csvtd.CsvTicFactory">CsvTicFactory</h1>

<pre><code class="python">CsvTicFactory(self, tic_dat_factory)
</code></pre>

<p>Primary class for reading/writing csv files with TicDat objects.
Your system will need the csv package if you want to use this class.
Don't create this object explicitly. A CsvTicFactory will
automatically be associated with the csv attribute of the parent</p>
<h2 id="ticdat.csvtd.CsvTicFactory.create_tic_dat">create_tic_dat</h2>

<pre><code class="python">CsvTicFactory.create_tic_dat(self, dir_path, dialect='excel', headers_present=True, freeze_it=False)
</code></pre>

<p>Create a TicDat object from the csv files in a directory</p>
<p>:param dir_path: the directory containing the .csv files.</p>
<p>:param dialect: the csv dialect. Consult csv documentation for details.</p>
<p>:param headers_present: Boolean. Does the first row of data contain the
                        column headers?</p>
<p>:param freeze_it: boolean. should the returned object be frozen?</p>
<p>:return: a TicDat object populated by the matching files.</p>
<p>caveats: Missing files resolve to an empty table, but missing fields on
         matching files throw an Exception.
         Data field values (but not primary key values) will be coerced
         into floats if possible.</p>
<h2 id="ticdat.csvtd.CsvTicFactory.find_duplicates">find_duplicates</h2>

<pre><code class="python">CsvTicFactory.find_duplicates(self, dir_path, dialect='excel', headers_present=True)
</code></pre>

<p>Find the row counts for duplicated rows.</p>
<p>:param dir_path: the directory containing .csv files.</p>
<p>:param dialect: the csv dialect. Consult csv documentation for details.</p>
<p>:param headers_present: Boolean. Does the first row of data contain
                        the column headers?</p>
<p>:return: A dictionary whose keys are the table names for the primary key tables.
         Each value of the return dictionary is itself a dictionary.
         The inner dictionary is keyed by the primary key values encountered
         in the table, and the value is the count of records in the
         Excel sheet with this primary key.
         Row counts smaller than 2 are pruned off, as they aren't duplicates</p>
<p>caveats: Missing files resolve to an empty table, but missing fields (data or primary key) on
         matching files throw an Exception.</p>
<h2 id="ticdat.csvtd.CsvTicFactory.write_directory">write_directory</h2>

<pre><code class="python">CsvTicFactory.write_directory(self, tic_dat, dir_path, allow_overwrite=False, dialect='excel', write_header=True)
</code></pre>

<p>write the ticDat data to a collection of csv files</p>
<p>:param tic_dat: the data object</p>
<p>:param dir_path: the directory in which to write the csv files</p>
<p>:param allow_overwrite: boolean - are we allowed to overwrite existing
                        files?</p>
<p>:param dialect: the csv dialect. Consult csv documentation for details.</p>
<p>:param write_header: Boolean. Should the header information be written
                     as the first row?</p>
<p>:return:</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../jsontd/" class="btn btn-neutral float-right" title="JsonTicFactory">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../ticdatfactory/" class="btn btn-neutral" title="TicDatFactory"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/ticdat/ticdat/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../ticdatfactory/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../jsontd/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
